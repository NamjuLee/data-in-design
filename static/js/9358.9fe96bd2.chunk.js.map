{"version":3,"file":"static/js/9358.9fe96bd2.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/layers/TileLayerView.js","../node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js","../node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos?.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return\"dot-density\"===n.type||n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)throw new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a});if(\"tile\"!==a.type)throw new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type});const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{equals as l}from\"../../../geometry/support/spatialReferenceUtils.js\";import{BitmapTileLayerView2D as o}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as h}from\"./LayerView2D.js\";import{createBlankImage as n,resampleImage as c}from\"./support/imageUtils.js\";import p from\"../tiling/TileInfoView.js\";import u from\"../tiling/TileKey.js\";import f from\"../tiling/TileQueue.js\";import m from\"../tiling/TileStrategy.js\";import y from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import g from\"../../layers/TileLayerView.js\";import{createQueryGeometry as w}from\"../../support/drapedUtils.js\";const _=[0,0];let I=class extends(g(d(o(h(y))))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this.layer=null}get resampling(){return!(\"resampling\"in this.layer)||!1!==this.layer.resampling}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume()}attach(){const e=\"tileServers\"in this.layer?this.layer.tileServers:null;this._tileInfoView=new p(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new f({tileInfoView:this._tileInfoView,concurrency:e&&10*e.length||10,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new m({cachePolicy:\"keep\",resampling:this.resampling,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.requestUpdate(),this.handles.add(s((()=>this.resampling),(()=>{this.doRefresh()}))),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}supportsSpatialReference(e){return l(this.layer.tileInfo?.spatialReference,e)}createFetchPopupFeaturesQueryGeometry(e,t){return w(e,t,this.view)}async doRefresh(){!this.attached||this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>this._enqueueTileFetch(e))))}isUpdating(){return this._fetchQueue?.updating??!1}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(_,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e,t={}){const s=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:r,resamplingLevel:a=0}=t;if(!s)try{return await this._fetchImage(e,r)}catch(h){if(!i(h)&&!this.resampling)return n(this._tileInfoView.tileInfo.size);if(a<3){const i=this._tileInfoView.getTileParentId(e.id);if(i){const s=new u(i),r=await this.fetchTile(s,{...t,resamplingLevel:a+1});return c(this._tileInfoView,r,s,e)}}throw h}const l=new u(0,0,0,0);let o;try{if(await s.fetchAvailabilityUpsample(e.level,e.row,e.col,l,{signal:r}),l.level!==e.level&&!this.resampling)return n(this._tileInfoView.tileInfo.size);o=await this._fetchImage(l,r)}catch(h){if(i(h))throw h;o=await this._fetchImage(e,r)}return this.resampling?c(this._tileInfoView,o,l,e):o}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(s){i(s)||t.getLogger(this.declaredClass).error(s)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchImageBitmapTile(e.level,e.row,e.col,{signal:t})}};e([r()],I.prototype,\"_fetchQueue\",void 0),e([r()],I.prototype,\"resampling\",null),I=e([a(\"esri.views.2d.layers.TileLayerView2D\")],I);const V=I;export{V as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"names":["t","e","xoffset","Math","max","abs","yoffset","n","stops","length","r","s","size","filter","type","map","maxSize","minSize","o","f","floor","renderer","event","pointerType","visualVariables","symbol","_n$uniqueValueInfos","uniqueValueInfos","forEach","classBreakInfos","i","c","fetchPopupFeatures","layer","a","this","get","allSublayers","toArray","minScale","maxScale","popupTemplate","popupEnabled","visible","async","createQuery","p","geometry","createFetchPopupFeaturesQueryGeometry","outFields","getRequiredFields","queryFeatures","features","then","concat","value","Boolean","prototype","_","I","g","d","h","y","constructor","super","arguments","_tileStrategy","_fetchQueue","resampling","update","pause","state","resume","attach","tileServers","_tileInfoView","tileInfo","fullExtent","tileInfoView","concurrency","process","fetchTile","m","cachePolicy","acquireTile","releaseTile","requestUpdate","handles","add","doRefresh","detach","destroy","clear","container","removeAllChildren","moveStart","viewChange","moveEnd","supportsSpatialReference","_this$layer$tileInfo","l","spatialReference","w","view","attached","updateRequested","suspended","reset","tiles","_enqueueTileFetch","isUpdating","_this$_fetchQueue$upd","_this$_fetchQueue","updating","_bitmapView","createTile","bitmap","x","getTileCoords","key","resolution","getTileResolution","width","height","addChild","abort","id","removeChild","once","undefined","tilemapCache","signal","resamplingLevel","_fetchImage","getTileParentId","u","_objectSpread","fetchAvailabilityUpsample","level","row","col","has","push","source","getLogger","declaredClass","error","fetchImageBitmapTile","V","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","xmin","min","ymin","xmax","ymax"],"sourceRoot":""}