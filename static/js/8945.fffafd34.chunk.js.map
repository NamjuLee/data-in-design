{"version":3,"file":"static/js/8945.fffafd34.chunk.js","mappings":"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","sources":["lib/RendererJSAPI/Event.ts","lib/RendererJSAPI/index.ts","CLASS_17_CAD_App_Development/Mapping/index.ts"],"sourcesContent":["// import { RendererJSAPI } from './RendererJSAPI';\r\n\r\nexport enum MOUSE_TYPE {\r\n    DOWN = 'DOWN',\r\n    UP = 'UP',\r\n    MOVE = 'MOVE',\r\n    CLICK = 'CLICK',\r\n    DRAG = 'DRAG',\r\n}\r\n\r\nexport class EventInteraction {\r\n    static mouseEventDataPre: MouseEventData;\r\n    app: any\r\n    isDown = false;\r\n    constructor(app: any) {\r\n        this.app = app;\r\n        EventInteraction.mouseEventDataPre = new MouseEventData();\r\n        this.InitArcGISMapEventV4x();\r\n    }\r\n    public InitArcGISMapEventV4x() {\r\n        this.app.mView.watch('size', () => {\r\n            this.app.ctx.canvas.width = this.app.mView.container.clientWidth;\r\n            this.app.ctx.canvas.height = this.app.mView.container.clientHeight;\r\n            this.app.resizeCanvas(this.app.mView.container.clientWidth, this.app.mView.container.clientHeight);\r\n        });\r\n        this.app.mView.on('pointer-down', (e: any) => {\r\n            const ev = this.CommonEventBuilderArcGIS(e);\r\n            ev.type = MOUSE_TYPE.DOWN;\r\n            ev.isDown = true;\r\n            this.isDown = true;\r\n            this.app.mouseEvent(ev);\r\n        });\r\n        this.app.mView.on('pointer-up', (e: any) => {\r\n            const ev = this.CommonEventBuilderArcGIS(e);\r\n            ev.type = MOUSE_TYPE.UP;\r\n            ev.isDown = false;\r\n            this.isDown = false;\r\n            this.app.mouseEvent(ev);\r\n        });\r\n        this.app.mView.on('click', (e: any) => {\r\n            const ev = this.CommonEventBuilderArcGIS(e);\r\n            ev.type = MOUSE_TYPE.CLICK;\r\n            this.app.mouseEvent(ev);\r\n        });\r\n        this.app.mView.on('drag', (e: any) => {\r\n            if (!this.isDown) { return; }\r\n            if (this.app.disablePan) {\r\n                e.stopPropagation();\r\n                // console.log(1);\r\n            }\r\n            const ev = this.CommonEventBuilderArcGIS(e);\r\n            // console.log(2);\r\n            ev.type = MOUSE_TYPE.DRAG;\r\n            this.app.mouseEvent(ev);\r\n        });\r\n        this.app.mView.on('pointer-move', (e: any) => {\r\n            if (this.isDown) { return; }\r\n            const ev = this.CommonEventBuilderArcGIS(e);\r\n            ev.type = MOUSE_TYPE.MOVE;\r\n            this.app.mouseEvent(ev);\r\n        });\r\n        this.app.mView.on('key-down', (e: any) => {\r\n            let keyPressed = e.key;\r\n            if (keyPressed.slice(0, 5) === 'Arrow' || e.key === '-' || e.key === '=' || e.key === 'd') {\r\n                e.stopPropagation();\r\n            }\r\n\r\n            this.KeyDownJSAPI4X(e.native);\r\n        });\r\n    }\r\n    private CommonEventBuilderArcGIS(e: any): MouseEventData {\r\n        let mEvent: MouseEventData = new MouseEventData();\r\n        mEvent.preX = EventInteraction.mouseEventDataPre.x;\r\n        mEvent.preY = EventInteraction.mouseEventDataPre.y;\r\n        mEvent.x = e.x;\r\n        mEvent.y = e.y;\r\n        mEvent.yGLPicking = e.native.target.getBoundingClientRect().bottom - e.native.clientY;\r\n        mEvent.pressedShift = e.native.shiftKey;\r\n        mEvent.pressedAlt = e.native.altKey;\r\n        mEvent.pressedCtrl = e.native.ctrlKey;\r\n\r\n        mEvent.native = e.native;\r\n        EventInteraction.mouseEventDataPre = mEvent;\r\n        return mEvent;\r\n    }\r\n    private KeyDownJSAPI4X(k: KeyboardEvent) {\r\n        let kEventData: KeyboardEventData = this.CommonEventBuilder(k);\r\n        this.app.keyDown(k);\r\n    }\r\n    private CommonEventBuilder(k: KeyboardEvent): KeyboardEventData {\r\n        let kEvent: KeyboardEventData = new KeyboardEventData();\r\n        kEvent.key = k.key;\r\n        kEvent.keyCode = k.keyCode;\r\n        kEvent.code = k.code;\r\n        kEvent.hasCtrlKey = k.ctrlKey;\r\n        kEvent.hasShiftKey = k.shiftKey;\r\n        kEvent.hasAltKey = k.altKey;\r\n        kEvent.hasMetaCommand = k.metaKey;\r\n        return kEvent;\r\n    }\r\n}\r\nexport class MouseEventData {\r\n    x: number = -1; y: number = -1; z: number = -1;\r\n    preX: number = -1; preY: number = -1; preZ: number = -1;\r\n    yGLPicking: number;\r\n    isDown: boolean = false;\r\n    isDoubleClick: boolean = false;\r\n    isMove: boolean = false;\r\n    pressedShift: boolean = false;\r\n    pressedAlt: boolean = false;\r\n    pressedCtrl: boolean = false;\r\n    lat: number = -1;\r\n    long: number = -1;\r\n    wheel: number = 0;\r\n    preWheel: number = 0;\r\n    type: MOUSE_TYPE;\r\n    native: MouseEvent;\r\n    constructor() {\r\n        // TODO\r\n    }\r\n    public DeepCopy() {\r\n        let mEvent = new MouseEventData();\r\n        mEvent.x = this.x; mEvent.y = this.y; mEvent.z = this.z; mEvent.preX = this.preX; mEvent.preY = this.preY; mEvent.preZ = this.preZ;\r\n        mEvent.pressedAlt = this.pressedAlt; mEvent.pressedShift = this.pressedShift; mEvent.pressedCtrl = this.pressedCtrl;\r\n        mEvent.isDoubleClick = this.isDoubleClick; mEvent.isDown = this.isDown; mEvent.isMove = this.isMove;\r\n        mEvent.lat = this.lat; mEvent.long = this.long; mEvent.wheel = this.wheel; mEvent.preWheel = this.preWheel;\r\n        mEvent.yGLPicking = this.yGLPicking;\r\n        mEvent.native = this.native;\r\n        return mEvent;\r\n    }\r\n}\r\nexport class KeyboardEventData {\r\n    preEvent: KeyboardEventData;\r\n    key: string;\r\n    hasAltKey: boolean;\r\n    hasCtrlKey: boolean;\r\n    hasShiftKey: boolean;\r\n    hasMetaCommand: boolean;\r\n    code: string;\r\n    keyCode: number;\r\n    constructor() {\r\n        // TODO\r\n    }\r\n}","import MapView from '@arcgis/core/views/MapView';\r\nimport Map from '@arcgis/core/Map';\r\n\r\nimport {\r\n  EventInteraction,\r\n  MouseEventData,\r\n  KeyboardEventData,\r\n  MOUSE_TYPE,\r\n} from './Event';\r\n\r\n\r\nexport class RendererJSAPI {\r\n  id: string;\r\n  time: number;\r\n  canvas: HTMLCanvasElement;\r\n  ctx: CanvasRenderingContext2D;\r\n  eventInteraction: EventInteraction;\r\n  mView: any;\r\n  mPoint = {spatialReference: null , longitude: 0, latitude: 0 };\r\n  hostDiv: HTMLElement;\r\n  disablePan: boolean = false;\r\n  isStatic: boolean = false;\r\n  constructor(id: string) {\r\n    console.log({id})\r\n    this.hostDiv = document.getElementById(id) as HTMLDivElement;\r\n    console.log(this.hostDiv)\r\n    this.hostDiv.style.display = 'flex'\r\n    const map = new Map({\r\n      basemap: 'dark-gray-vector', // topo, dark-gray-vector, streets, streets-night-vector\r\n    });\r\n    const view = new MapView({\r\n      container: id,\r\n      map,\r\n      zoom: 15,\r\n      center: [-71.0933575, 42.3591654],\r\n      ui: { components: [] }, // do display any widgets\r\n    });\r\n    // view.ui.remove(\"zoom\");\r\n    view.when(() => {\r\n\r\n      // const zoomWidget = new Zoom({\r\n      //   view: view\r\n      // });\r\n      // view.ui.add(zoomWidget, \"top-right\");\r\n\r\n      // view.ui.add({\r\n      //   component: new Zoom({ view }),\r\n      //   position: 'top-right',\r\n      // });\r\n      \r\n      // param.view = view;\r\n      // this.app = new ControllerLabs(param);\r\n\r\n      this.mView = view;\r\n      // console.log(this.mView);\r\n      // console.log(this.mView.spatialReference);\r\n\r\n      this.canvas = document.createElement('canvas');\r\n      this.canvas.id = 'digitalMappingVisualization';\r\n      this.canvas.style.zIndex = '1';\r\n      this.canvas.style.position = 'absolute';\r\n      this.canvas.style.pointerEvents = 'none';\r\n\r\n      this.ctx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\r\n\r\n      this.mView.container.appendChild(this.canvas);\r\n      this.hostDiv = this.mView.container;\r\n      this.ctx.globalCompositeOperation = 'source-over';\r\n      this.canvas.width = this.mView.container.clientWidth;\r\n      this.canvas.height = this.mView.container.clientHeight;\r\n\r\n      this.eventInteraction = new EventInteraction(this);\r\n\r\n      this.mPoint = this.mView.toMap({ x: 0, y: 0 });\r\n      this.mPoint.spatialReference = (this.mView as MapView).spatialReference;\r\n      this.mView.zoom = 16;\r\n      this.initPost();\r\n      this.start();\r\n    });\r\n  }\r\n  public initPost() {\r\n    // TODO\r\n  }\r\n  public mouseEvent(m: MouseEventData) {\r\n    if (m.type === MOUSE_TYPE.DOWN) {\r\n      this.mouseDown(m.x, m.y);\r\n      return;\r\n    }\r\n    if (m.type === MOUSE_TYPE.UP) {\r\n      this.mouseUp(m.x, m.y);\r\n      return;\r\n    }\r\n    if (m.type === MOUSE_TYPE.CLICK) {\r\n      this.mouseClick(m.x, m.y);\r\n      return;\r\n    }\r\n    if (m.type === MOUSE_TYPE.DRAG) {\r\n      this.mouseDrag(m.x, m.y);\r\n      return;\r\n    } else {\r\n      this.mouseMove(m.x, m.y);\r\n      return;\r\n    }\r\n  }\r\n  public start() {\r\n    this.time = 0.0;\r\n    this.draw(this.ctx);\r\n  }\r\n  public draw(ctx: CanvasRenderingContext2D) {\r\n    if (this.isStatic) {\r\n      return;\r\n    }\r\n    requestAnimationFrame(() => {\r\n      this.draw(this.ctx);\r\n    });\r\n    this.clear(this.ctx);\r\n    this.time += 0.1;\r\n    this.ctx && this.render(this.ctx);\r\n  }\r\n  public clear(ctx: CanvasRenderingContext2D) {\r\n    ctx && ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n  }\r\n  // ...................................................\r\n  public center(lon: number, lat: number) {\r\n    this.mPoint.longitude = lon;\r\n    this.mPoint.latitude = lat;\r\n    this.mView.center = this.mPoint;\r\n  }\r\n  public zoom(z: number) {\r\n    this.mView.zoom = z;\r\n  }\r\n  public toScreen = (long: number, lat: number): number[] => {\r\n    this.mPoint.longitude = long;\r\n    this.mPoint.latitude = lat;\r\n\r\n    // this.mPoint.spatialReference.wkid = 102100;\r\n    let p = this.mView.toScreen(this.mPoint);\r\n    return [p.x, p.y]; // screen X Y\r\n  };\r\n  public toMap = (x: number, y: number): number[] => {\r\n    let mp = this.mView.toMap({ x: x, y: y }).clone();\r\n    return [mp.longitude, mp.latitude, mp.x, mp.y];\r\n  };\r\n  public destroy() {\r\n    this.isStatic = true;\r\n    // this.mView.destroy();\r\n\r\n    // while (this.mView && this.mView.container.lastElementChild) {\r\n    //   this.mView.container.removeChild(this.mView.container.lastElementChild);\r\n    // }\r\n\r\n    if (this.hostDiv) {\r\n      try {\r\n        // More efficient way to remove all children\r\n        while (this.hostDiv.firstChild) {\r\n          this.hostDiv.removeChild(this.hostDiv.firstChild);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error in destroy method:', error);\r\n      }\r\n    } else {\r\n      console.warn('hostDiv is undefined in destroy method');\r\n    }\r\n  }\r\n  // ...................................................\r\n  public render(ctx: CanvasRenderingContext2D) {\r\n    // Bind needed\r\n  }\r\n  public keyDown(k: KeyboardEvent) {\r\n    // Bind needed\r\n  }\r\n  public mouseClick(x: number, y: number) {\r\n    // Bind needed\r\n  }\r\n  public mouseDown(x: number, y: number) {\r\n    // Bind needed\r\n  }\r\n  public mouseUp(x: number, y: number) {\r\n    // Bind needed\r\n  }\r\n  public mouseDrag(x: number, y: number) {\r\n    // Bind needed\r\n  }\r\n  public mouseMove(x: number, y: number) {\r\n    // Bind needed\r\n  }\r\n  public resizeCanvas(width: number, height: number) {\r\n    // Bind needed\r\n  }\r\n}\r\n","import { RendererJSAPI } from '../../lib/RendererJSAPI'\nimport { getJSONFromURL } from 'njscore';\n\nexport class Solution extends RendererJSAPI {\n\n    locations: number[][] = [];\n    colors: string[] = [];\n    names: string[] = [];\n\n    // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n    constructor(view: any) {\n      super(view)\n    }\n    public initPost() {\n      // TODO\n      // You code goes here for one time operation\n      const colorsTempate = {\n          'blue' : \"#0683d2\",\n          'red' : \"#ec2f3d\",\n          'orange' : \"#ff961e\",\n          'green' : \"#049564\",\n          'silver' : \"#959597\",\n      }\n      \n      getJSONFromURL(process.env.PUBLIC_URL + '/static/data/MBTA_stop.geojson').then((d) => {\n          let lonSum = 0;\n          let latSum = 0;\n          let count = 0;\n\n          for (let i = 0 ; i < d['features'].length; ++i) {\n              const loc = d['features'][i]['geometry']['coordinates'];\n\n              this.locations.push(loc);\n              lonSum += loc[0];\n              latSum += loc[1];\n              count++;\n\n              this.names.push(d['features'][i]['properties']['name']);\n\n              const line: string[] = d['features'][i]['properties']['lines'];\n\n              if (line.includes('blue')) {\n                  this.colors.push(colorsTempate['blue']);\n              } else if (line.includes('red')) {\n                  this.colors.push(colorsTempate['red']); continue;\n              } else if (line.includes('orange')) {\n                  this.colors.push(colorsTempate['orange']); continue;\n              } else if (line.includes('green')) {\n                  this.colors.push(colorsTempate['green']); continue;\n              } else {\n                  this.colors.push(colorsTempate['silver']);\n              }\n\n          }\n          this.center(lonSum / count, latSum / count);\n\n      });\n    }\n    public render(ctx: CanvasRenderingContext2D): void {\n        // TODO\n        // You code goes here for the rending loop\n        for (let i = 0; i < this.locations.length; ++i) { \n            const projected = this.toScreen(this.locations[i][0], this.locations[i][1]); \n            renderPoint(ctx, projected[0], projected[1], this.time, this.colors[i]);\n            renderText(ctx, projected[0], projected[1], this.names[i], this.colors[i]);\n        }\n\n        // // !! can stop render after this frame.\n        // this.isStatic = true;\n    }\n}\n\nconst renderPoint = (ctx: CanvasRenderingContext2D, x: number, y: number, t: number, color: string) => {\n    ctx.fillStyle = color;\n    ctx.strokeStyle = '#fff';\n    ctx.lineWidth = 0.75;\n    ctx.beginPath();\n    ctx.arc(x, y, (Math.sin(t * 0.8) + 4) * 2, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n};\nconst renderText = (ctx: CanvasRenderingContext2D, x: number, y: number, name: string, color: string) => {\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 0.5;\n    ctx.strokeText(name, x + 13, y);\n};\n\n\n"],"names":["MOUSE_TYPE","EventInteraction","constructor","app","isDown","this","mouseEventDataPre","MouseEventData","InitArcGISMapEventV4x","mView","watch","ctx","canvas","width","container","clientWidth","height","clientHeight","resizeCanvas","on","e","ev","CommonEventBuilderArcGIS","type","DOWN","mouseEvent","UP","CLICK","disablePan","stopPropagation","DRAG","MOVE","key","slice","KeyDownJSAPI4X","native","mEvent","preX","x","preY","y","yGLPicking","target","getBoundingClientRect","bottom","clientY","pressedShift","shiftKey","pressedAlt","altKey","pressedCtrl","ctrlKey","k","CommonEventBuilder","keyDown","kEvent","KeyboardEventData","keyCode","code","hasCtrlKey","hasShiftKey","hasAltKey","hasMetaCommand","metaKey","z","preZ","isDoubleClick","isMove","lat","long","wheel","preWheel","DeepCopy","preEvent","RendererJSAPI","id","time","eventInteraction","mPoint","spatialReference","longitude","latitude","hostDiv","isStatic","toScreen","p","toMap","mp","clone","console","log","document","getElementById","style","display","map","Map","basemap","view","MapView","zoom","center","ui","components","when","createElement","zIndex","position","pointerEvents","getContext","appendChild","globalCompositeOperation","initPost","start","m","mouseDrag","mouseMove","mouseClick","mouseUp","mouseDown","draw","requestAnimationFrame","clear","render","clearRect","lon","destroy","firstChild","removeChild","error","warn","Solution","super","locations","colors","names","colorsTempate","getJSONFromURL","process","then","d","lonSum","latSum","count","i","length","loc","push","line","includes","projected","renderPoint","renderText","t","color","fillStyle","strokeStyle","lineWidth","beginPath","arc","Math","sin","PI","closePath","fill","stroke","name","strokeText"],"sourceRoot":""}