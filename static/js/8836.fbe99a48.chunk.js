"use strict";(self.webpackChunkdata_in_design=self.webpackChunkdata_in_design||[]).push([[8836],{98836:(t,i,e)=>{e.r(i),e.d(i,{Solution:()=>p});var s=e(75481),o=e(30851);let n=function(t){return t.DOWN="DOWN",t.UP="UP",t.MOVE="MOVE",t.CLICK="CLICK",t.DRAG="DRAG",t}({});class h{constructor(t){this.app=void 0,this.isDown=!1,this.app=t,h.mouseEventDataPre=new a,this.InitArcGISMapEventV4x()}InitArcGISMapEventV4x(){this.app.mView.watch("size",(()=>{this.app.ctx.canvas.width=this.app.mView.container.clientWidth,this.app.ctx.canvas.height=this.app.mView.container.clientHeight,this.app.resizeCanvas(this.app.mView.container.clientWidth,this.app.mView.container.clientHeight)})),this.app.mView.on("pointer-down",(t=>{const i=this.CommonEventBuilderArcGIS(t);i.type=n.DOWN,i.isDown=!0,this.isDown=!0,this.app.mouseEvent(i)})),this.app.mView.on("pointer-up",(t=>{const i=this.CommonEventBuilderArcGIS(t);i.type=n.UP,i.isDown=!1,this.isDown=!1,this.app.mouseEvent(i)})),this.app.mView.on("click",(t=>{const i=this.CommonEventBuilderArcGIS(t);i.type=n.CLICK,this.app.mouseEvent(i)})),this.app.mView.on("drag",(t=>{if(!this.isDown)return;this.app.disablePan&&t.stopPropagation();const i=this.CommonEventBuilderArcGIS(t);i.type=n.DRAG,this.app.mouseEvent(i)})),this.app.mView.on("pointer-move",(t=>{if(this.isDown)return;const i=this.CommonEventBuilderArcGIS(t);i.type=n.MOVE,this.app.mouseEvent(i)})),this.app.mView.on("key-down",(t=>{"Arrow"!==t.key.slice(0,5)&&"-"!==t.key&&"="!==t.key&&"d"!==t.key||t.stopPropagation(),this.KeyDownJSAPI4X(t.native)}))}CommonEventBuilderArcGIS(t){let i=new a;return i.preX=h.mouseEventDataPre.x,i.preY=h.mouseEventDataPre.y,i.x=t.x,i.y=t.y,i.yGLPicking=t.native.target.getBoundingClientRect().bottom-t.native.clientY,i.pressedShift=t.native.shiftKey,i.pressedAlt=t.native.altKey,i.pressedCtrl=t.native.ctrlKey,i.native=t.native,h.mouseEventDataPre=i,i}KeyDownJSAPI4X(t){this.CommonEventBuilder(t);this.app.keyDown(t)}CommonEventBuilder(t){let i=new r;return i.key=t.key,i.keyCode=t.keyCode,i.code=t.code,i.hasCtrlKey=t.ctrlKey,i.hasShiftKey=t.shiftKey,i.hasAltKey=t.altKey,i.hasMetaCommand=t.metaKey,i}}h.mouseEventDataPre=void 0;class a{constructor(){this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.yGLPicking=void 0,this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.lat=-1,this.long=-1,this.wheel=0,this.preWheel=0,this.type=void 0,this.native=void 0}DeepCopy(){let t=new a;return t.x=this.x,t.y=this.y,t.z=this.z,t.preX=this.preX,t.preY=this.preY,t.preZ=this.preZ,t.pressedAlt=this.pressedAlt,t.pressedShift=this.pressedShift,t.pressedCtrl=this.pressedCtrl,t.isDoubleClick=this.isDoubleClick,t.isDown=this.isDown,t.isMove=this.isMove,t.lat=this.lat,t.long=this.long,t.wheel=this.wheel,t.preWheel=this.preWheel,t.yGLPicking=this.yGLPicking,t.native=this.native,t}}class r{constructor(){this.preEvent=void 0,this.key=void 0,this.hasAltKey=void 0,this.hasCtrlKey=void 0,this.hasShiftKey=void 0,this.hasMetaCommand=void 0,this.code=void 0,this.keyCode=void 0}}class c{constructor(t){this.id=void 0,this.time=void 0,this.canvas=void 0,this.ctx=void 0,this.eventInteraction=void 0,this.mView=void 0,this.mPoint={spatialReference:null,longitude:0,latitude:0},this.hostDiv=void 0,this.disablePan=!1,this.isStatic=!1,this.toScreen=(t,i)=>{this.mPoint.longitude=t,this.mPoint.latitude=i;let e=this.mView.toScreen(this.mPoint);return[e.x,e.y]},this.toMap=(t,i)=>{let e=this.mView.toMap({x:t,y:i}).clone();return[e.longitude,e.latitude,e.x,e.y]},console.log({id:t}),this.hostDiv=document.getElementById(t),console.log(this.hostDiv),this.hostDiv.style.display="flex";const i=new o.A({basemap:"dark-gray-vector"}),e=new s.A({container:t,map:i,zoom:15,center:[-71.0933575,42.3591654],ui:{components:[]}});e.when((()=>{this.mView=e,this.canvas=document.createElement("canvas"),this.canvas.id="digitalMappingVisualization",this.canvas.style.zIndex="1",this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d"),this.mView.container.appendChild(this.canvas),this.hostDiv=this.mView.container,this.ctx.globalCompositeOperation="source-over",this.canvas.width=this.mView.container.clientWidth,this.canvas.height=this.mView.container.clientHeight,this.eventInteraction=new h(this),this.mPoint=this.mView.toMap({x:0,y:0}),this.mPoint.spatialReference=this.mView.spatialReference,this.mView.zoom=16,this.initPost(),this.start()}))}initPost(){}mouseEvent(t){if(t.type!==n.DOWN)if(t.type!==n.UP){if(t.type!==n.CLICK)return t.type===n.DRAG?void this.mouseDrag(t.x,t.y):void this.mouseMove(t.x,t.y);this.mouseClick(t.x,t.y)}else this.mouseUp(t.x,t.y);else this.mouseDown(t.x,t.y)}start(){this.time=0,this.draw(this.ctx)}draw(t){this.isStatic||(requestAnimationFrame((()=>{this.draw(this.ctx)})),this.clear(this.ctx),this.time+=.1,this.ctx&&this.render(this.ctx))}clear(t){t&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}center(t,i){this.mPoint.longitude=t,this.mPoint.latitude=i,this.mView.center=this.mPoint}zoom(t){this.mView.zoom=t}destroy(){if(this.isStatic=!0,this.hostDiv)try{for(;this.hostDiv.firstChild;)this.hostDiv.removeChild(this.hostDiv.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("hostDiv is undefined in destroy method")}render(t){}keyDown(t){}mouseClick(t,i){}mouseDown(t,i){}mouseUp(t,i){}mouseDrag(t,i){}mouseMove(t,i){}resizeCanvas(t,i){}}var l=e(71123);class p extends c{constructor(t){super(t),this.locations=[],this.colors=[],this.names=[]}initPost(){const t="#0683d2",i="#ec2f3d",e="#ff961e",s="#049564",o="#959597";(0,l.getJSONFromURL)("/data-in-design/static/data/MBTA_stop.geojson").then((n=>{let h=0,a=0,r=0;for(let c=0;c<n.features.length;++c){const l=n.features[c].geometry.coordinates;this.locations.push(l),h+=l[0],a+=l[1],r++,this.names.push(n.features[c].properties.name);const p=n.features[c].properties.lines;if(p.includes("blue"))this.colors.push(t);else{if(p.includes("red")){this.colors.push(i);continue}if(p.includes("orange")){this.colors.push(e);continue}if(p.includes("green")){this.colors.push(s);continue}this.colors.push(o)}}this.center(h/r,a/r)}))}render(t){for(let i=0;i<this.locations.length;++i){const e=this.toScreen(this.locations[i][0],this.locations[i][1]);d(t,e[0],e[1],this.time,this.colors[i]),m(t,e[0],e[1],this.names[i],this.colors[i])}}}const d=(t,i,e,s,o)=>{t.fillStyle=o,t.strokeStyle="#fff",t.lineWidth=.75,t.beginPath(),t.arc(i,e,2*(Math.sin(.8*s)+4),0,2*Math.PI),t.closePath(),t.fill(),t.stroke()},m=(t,i,e,s,o)=>{t.strokeStyle=o,t.lineWidth=.5,t.strokeText(s,i+13,e)}}}]);
//# sourceMappingURL=8836.fbe99a48.chunk.js.map