"use strict";(self.webpackChunkdata_in_design=self.webpackChunkdata_in_design||[]).push([[3616],{63616:(e,t,i)=>{i.d(t,{d:()=>b});var s=i(8),r=i(18690),n=i(50076),a=i(53084),o=i(30726),u=i(79369),l=i(31633),c=i(42294),h=i(2413),p=i(65391),d=i(19902),f=i(1438),y=i(80963),m=i(98618),g=i(55468),x=i(24586),S=i(8298),R=i(57471),_=i(81376),w=i(23478),I=i(87159),F=i(1900),Q=i(98976),A=i(93523);const v="feature-store:unsupported-query";const G=new u.F(2e6);let C=0;class b{constructor(e){this.capabilities={query:S.F},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new u.Mn(C+++"$$",G)),this.fieldsIndex=new F.A(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,o.xt)(this._frameTask),this.clearCache(),(0,o.pR)(this._geometryQueryCache),this._changeHandle=(0,o.xt)(this._changeHandle),(0,o.pR)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return(0,o.$I)(e)?null:{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,I.ag)(this.spatialReference)}}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,w.W)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){var e;null!==(e=this._geometryQueryCache)&&void 0!==e&&e.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e,t){try{return(await this._executeQuery(e,{},t)).createQueryResponse()}catch(i){if(i!==I.sR)throw i;return new R.G([],e,this).createQueryResponse()}}async executeQueryForCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},t)).createQueryResponseForCount()}catch(i){if(i!==I.sR)throw i;return 0}}async executeQueryForExtent(e,t){const i=e.outSR;try{const s=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),r=s.size;if(!r)return{count:0,extent:null};(0,c.hZ)(T,c.dN),this.featureStore.forEachBounds(s.items,(e=>(0,c.RF)(T,e)),E);const n={xmin:T[0],ymin:T[1],xmax:T[3],ymax:T[4],spatialReference:(0,I.ag)(this.spatialReference)};this.hasZ&&isFinite(T[2])&&isFinite(T[5])&&(n.zmin=T[2],n.zmax=T[5]);const a=(0,x.Cv)(n,s.spatialReference,i);if(a.spatialReference=(0,I.ag)(i||this.spatialReference),a.xmax-a.xmin==0){const e=(0,l.GA)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=(0,l.GA)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=(0,l.GA)(a.spatialReference);a.zmin-=e,a.zmax+=e}return{count:r,extent:a}}catch(s){if(s===I.sR)return{count:0,extent:null};throw s}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){try{const i=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),s=i.items,r=new Set;return await this._reschedule((()=>{for(const e of s)r.add(i.featureAdapter.getObjectId(e))}),t),r}catch(i){if(i===I.sR)return new Set;throw i}}async executeQueryForSnapping(e,t){const{point:i,distance:r,types:n}=e;if(n===R.m.NONE)return{candidates:[]};const a=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),u=!(0,y.aI)(i.spatialReference,this.spatialReference);u&&await(0,x.Nk)(i.spatialReference,this.spatialReference);const l="number"==typeof r?r:r.x,c="number"==typeof r?r:r.y,h={xmin:i.x-l,xmax:i.x+l,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},p=u?(0,x.Cv)(h,this.spatialReference):h;if(!p)return{candidates:[]};const m=(await(0,f.el)((0,d.rS)(i),null,{signal:t}))[0],g=(await(0,f.el)((0,d.rS)(p),null,{signal:t}))[0];if((0,o.$I)(m)||(0,o.$I)(g))return{candidates:[]};const S=new R.G(this._searchFeatures(this._getQueryBBoxes(g.toJSON())),a,this);await this._reschedule((()=>this._executeObjectIdsQuery(S)),t),await this._reschedule((()=>this._executeTimeQuery(S)),t),await this._reschedule((()=>this._executeAttributesQuery(S)),t);const _=m.toJSON(),w=u?(0,x.Cv)(_,this.spatialReference):_,I=u?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:r;return S.createSnappingResponse((0,s.A)((0,s.A)({},e),{},{point:w,distance:I}),i.spatialReference)}async executeQueryForLatestObservations(e,t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new n.A(v,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});try{const i=await this._executeQuery(e,{},t);return await this._reschedule((()=>this._filterLatest(i)),t),i.createQueryResponse()}catch(i){if(i!==I.sR)throw i;return new R.G([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const{field:s,normalizationField:r,valueExpression:n}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:n},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const{field:s,field2:r,field3:n,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,field2:r,field3:n,valueExpression:a},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const{field:s,normalizationField:r,valueExpression:n}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:n},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const{field:s,normalizationField:r,valueExpression:n}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:n},i)).createHistogramResponse(t)}async _schedule(e,t){return(0,o.Ru)(this._frameTask)?this._frameTask.schedule(e,t):e(A.Bb)}async _reschedule(e,t){return(0,o.Ru)(this._frameTask)?this._frameTask.reschedule(e,t):e(A.Bb)}_getAll(e){return(0,o.$I)(this._allItems)&&(this._allItems=this.featureStore.toArray()),new R.G(this._allItems,e,this)}async _executeQuery(e,t,i){e=(0,a.o8)(e),e=await this._schedule((()=>(0,I.GC)(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkQuerySupport(e)),i),e=(0,s.A)((0,s.A)({},e),t);const r=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),n=await this._reschedule((()=>this._executeGeometryQuery(e,r,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(n)),i),await this._reschedule((()=>this._executeObjectIdsQuery(n)),i),await this._reschedule((()=>this._executeTimeQuery(n)),i),await this._reschedule((()=>this._executeAttributesQuery(n)),i),n}async _executeSceneFilterQuery(e,t){if((0,o.$I)(e.sceneFilter))return null;const{outSR:i,returnGeometry:s,returnCentroid:r}=e,n=this.featureStore.featureSpatialReference,a=e.sceneFilter.geometry,u=(0,o.$I)(n)||(0,y.aI)(n,a.spatialReference)?a:(0,x.Cv)(a,n);if(!u)return null;const l=s||r,c=(0,y.fn)(i)&&!(0,y.aI)(this.spatialReference,i)&&l?async e=>this._project(e,i):e=>e,h=this.featureAdapter,p=this._searchFeatures(this._getQueryBBoxes(u));if("disjoint"===e.sceneFilter.spatialRelationship){if(!p.length)return null;const i=new Set;for(const e of p)i.add(h.getObjectId(e));const s=await this._reschedule((()=>this.featureStore.toArray()),t);return c(await this._reschedule((async()=>{const r=await(0,_.xt)("esriSpatialRelDisjoint",u,this.geometryType,this.hasZ,this.hasM),n=await this._runSpatialFilter(s,(e=>!i.has(h.getObjectId(e))||r(h.getGeometry(e))),t);return new R.G(n,e,this)}),t))}if(!p.length)return new R.G([],e,this);if(this._canExecuteSinglePass(u,e))return c(new R.G(p,e,this));const d=await(0,_.xt)("esriSpatialRelContains",u,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(p,(e=>d(h.getGeometry(e))),t);return c(new R.G(f,e,this))}async _executeGeometryQuery(e,t,i){if((0,o.Ru)(t)&&0===t.items.length)return t;e=(0,o.Ru)(t)?t.query:e;const{geometry:s,outSR:n,spatialRel:a,returnGeometry:u,returnCentroid:l}=e,c=this.featureStore.featureSpatialReference,h=!s||(0,o.$I)(c)||(0,y.aI)(c,s.spatialReference)?s:(0,x.Cv)(s,c),p=u||l,d=(0,y.fn)(n)&&!(0,y.aI)(this.spatialReference,n),f=this._geometryQueryCache&&(0,o.$I)(t)?d&&p?JSON.stringify({originalFilterGeometry:s,spatialRelationship:a,outSpatialReference:n}):JSON.stringify({originalFilterGeometry:s,spatialRelationship:a}):null,m=f?this._geometryQueryCache.get(f):null;if((0,o.Ru)(m))return new R.G(m,e,this);const g=async e=>(d&&p&&await this._project(e,n),f&&this._geometryQueryCache.put(f,e.items,e.items.length+1),e);if(!h)return g((0,o.Ru)(t)?t:this._getAll(e));const S=this.featureAdapter;let w=this._searchFeatures(this._getQueryBBoxes(s));if("esriSpatialRelDisjoint"===a){if(!w.length)return g((0,o.Ru)(t)?t:this._getAll(e));const s=new Set;for(const e of w)s.add(S.getObjectId(e));const r=(0,o.Ru)(t)?t.items:await this._reschedule((()=>this.featureStore.toArray()),i),n=await this._reschedule((async()=>{const t=await(0,_.xt)(a,h,this.geometryType,this.hasZ,this.hasM),n=await this._runSpatialFilter(r,(e=>!s.has(S.getObjectId(e))||t(S.getGeometry(e))),i);return new R.G(n,e,this)}),i);return g(n)}if((0,o.Ru)(t)){const e=new r.vW;w=w.filter((i=>(0,r.qh)(t.items,i,t.items.length,e)>=0))}if(!w.length){const t=new R.G([],e,this);return f&&this._geometryQueryCache.put(f,t.items,1),t}if(this._canExecuteSinglePass(h,e))return g(new R.G(w,e,this));const I=await(0,_.xt)(a,h,this.geometryType,this.hasZ,this.hasM),F=await this._runSpatialFilter(w,(e=>I(S.getGeometry(e))),i);return g(new R.G(F,e,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||(0,o.$I)(this.aggregateAdapter))return;const t=new Set;for(const s of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(s).forEach((e=>t.add(e)));const i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const t=new Set(e.query.objectIds),i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=(0,w.I)(this.timeInfo,e.query.timeExtent,this.featureAdapter);(0,o.$I)(t)||(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=(0,g.j4)(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,i){if(!t)return e;if((0,o.$I)(this._frameTask))return e.filter((e=>t(e)));let s=0;const r=new Array,n=async a=>{for(;s<e.length;){const o=e[s++];t(o)&&(r.push(o),a.madeProgress()),a.done&&await this._reschedule((e=>n(e)),i)}};return this._reschedule((e=>n(e)),i).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:i,endTimeField:s}=this.timeInfo,r=s||i,n=new Map,a=this.featureAdapter.getAttribute;for(const o of e.items){const e=a(o,t),i=a(o,r),s=n.get(e);(!s||i>a(s,r))&&n.set(e,o)}e.items=Array.from(n.values())}_canExecuteSinglePass(e,t){const{spatialRel:i}=t;return(0,_.tC)(e)&&("esriSpatialRelEnvelopeIntersects"===i||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===i||"esriSpatialRelContains"===i||"esriSpatialRelWithin"===i))}async _project(e,t){if(!t||(0,y.aI)(this.spatialReference,t))return e;const i=this.featureAdapter,s=await(0,x.lK)(e.items.map((e=>(0,I.pL)(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t);return e.items=s.map(((t,s)=>i.cloneWithGeometry(e.items[s],(0,m.Ux)(t,this.hasZ,this.hasM)))),e}_getQueryBBoxes(e){if((0,_.tC)(e)){if((0,d.ZC)(e))return[(0,h.fA)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,d.Bi)(e))return e.rings.map((e=>(0,h.fA)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[(0,p.Rg)((0,h.vt)(),e)]}_searchFeatures(e){for(const i of e)this.featureStore.forEachInBounds(i,(e=>P.add(e)));const t=Array.from(P.values());return P.clear(),t}async _checkStatisticsSupport(e,t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new n.A(v,"Unsupported query options",{query:e});return this._checkAttributesQuerySupport(e),Promise.all([this._checkStatisticsParamsSupport(t),(0,_.c0)(e,this.geometryType,this.spatialReference),(0,x.Nk)(this.spatialReference,e.outSR)]).then((()=>e))}async _checkStatisticsParamsSupport(e){let t=[];if(e.valueExpression){const{arcadeUtils:i}=await(0,Q.lw)();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.field2&&t.push(e.field2),e.field3&&t.push(e.field3),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new n.A(v,"params should have at least a field or valueExpression",{params:e});(0,g.MG)(this.fieldsIndex,t,"params contains missing fields")}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new n.A(v,"Unsupported query options",{query:e});return this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Promise.all([(0,_.c0)(e,this.geometryType,this.spatialReference),(0,x.Nk)(this.spatialReference,e.outSR)]).then((()=>e))}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:i,returnDistinctValues:s,outStatistics:r}=e,a=r?r.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(i&&i.length>0){const e=" asc",t=" desc",s=i.map((i=>{const s=i.toLowerCase();return s.includes(e)?s.split(e)[0]:s.includes(t)?s.split(t)[0]:i})).filter((e=>!a.includes(e)));(0,g.MG)(this.fieldsIndex,s,"orderByFields contains missing fields")}if(t&&t.length>0)(0,g.MG)(this.fieldsIndex,t,"outFields contains missing fields");else if(s)throw new n.A(v,"outFields should be specified for returnDistinctValues",{query:e});(0,g.SN)(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:i,having:s}=e,r=i&&i.length,a=t&&t.length;if(s){if(!r||!a)throw new n.A(v,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});(0,g.eD)(this.fieldsIndex,s,t)}if(a){if(!function(e){return e.every((e=>"exceedslimit"!==e.statisticType))}(t))return;const s=t.map((e=>e.onStatisticField)).filter(Boolean);(0,g.MG)(this.fieldsIndex,s,"onStatisticFields contains missing fields"),r&&(0,g.MG)(this.fieldsIndex,i,"groupByFieldsForStatistics contains missing fields");for(const i of t){const{onStatisticField:t,statisticType:s}=i;if("percentile_disc"!==s&&"percentile_cont"!==s||!("statisticParameters"in i)){if("count"!==s&&t&&(0,g.Qu)(t,this.fieldsIndex))throw new n.A(v,"outStatistics contains non-numeric fields",{definition:i,query:e})}else{const{statisticParameters:t}=i;if(!t)throw new n.A(v,"statisticParamters should be set for percentile type",{definition:i,query:e})}}}}async _getQueryEngineResultForStats(e,t,i){e=(0,a.o8)(e);try{e=await this._schedule((()=>(0,I.GC)(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkStatisticsSupport(e,t)),i);const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),r=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(r)),i),await this._reschedule((()=>this._executeObjectIdsQuery(r)),i),await this._reschedule((()=>this._executeTimeQuery(r)),i),await this._reschedule((()=>this._executeAttributesQuery(r)),i),r}catch(s){if(s!==I.sR)throw s;return new R.G([],e,this)}}}const E=(0,c.vt)(),T=(0,c.vt)(),P=new Set},8298:(e,t,i)=>{i.d(t,{F:()=>s});const s={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},81376:(e,t,i)=>{i.d(t,{tC:()=>_,c0:()=>R,xt:()=>S});var s=i(50076),r=i(11352),n=i(65658);var a=i(19902),o=i(80963);function u(e,t){return e?t?4:3:t?3:2}function l(e,t,i,s,r,n){const a=u(r,n),{coords:o,lengths:l}=s;if(!l)return!1;for(let u=0,h=0;u<l.length;u++,h+=a)if(!c(e,t,i,o[h],o[h+1]))return!1;return!0}function c(e,t,i,s,r){if(!e)return!1;const n=u(t,i),{coords:a,lengths:o}=e;let l=!1,c=0;for(const u of o)l=h(l,a,n,c,u,s,r),c+=u*n;return l}function h(e,t,i,s,r,n,a){let o=e,u=s;for(let l=s,c=s+r*i;l<c;l+=i){u=l+i,u===c&&(u=s);const e=t[l],r=t[l+1],h=t[u],p=t[u+1];(r<a&&p>=a||p<a&&r>=a)&&e+(a-r)/(p-r)*(h-e)<n&&(o=!o)}return o}var p=i(98618),d=i(1484),f=i(24586),y=i(87159);const m="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},x={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function S(e,t,s,o,u){if((0,a.Bi)(t)&&"esriGeometryPoint"===s&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,p.Ye)(new d.A,t,!1,!1);return Promise.resolve((t=>function(e,t,i,s){return c(e,t,i,s.coords[0],s.coords[1])}(e,!1,!1,t)))}if((0,a.Bi)(t)&&"esriGeometryMultipoint"===s){const i=(0,p.Ye)(new d.A,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>l(i,!1,!1,e,o,u)))}if((0,a.ZC)(t)&&"esriGeometryPoint"===s&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>(0,r.qz)(t,(0,y.pL)(s,o,u,e))));if((0,a.ZC)(t)&&"esriGeometryMultipoint"===s&&"esriSpatialRelContains"===e)return Promise.resolve((e=>(0,r.rL)(t,(0,y.pL)(s,o,u,e))));if((0,a.ZC)(t)&&"esriSpatialRelIntersects"===e){const e=function(e){return"mesh"===e?n.xB:(0,n.xK)(e)}(s);return Promise.resolve((i=>e(t,(0,y.pL)(s,o,u,i))))}return Promise.all([i.e(2612),i.e(4050)]).then(i.bind(i,1669)).then((i=>{const r=i[g[e]].bind(null,t.spatialReference,t);return e=>r((0,y.pL)(s,o,u,e))}))}async function R(e,t,i){const{spatialRel:r,geometry:n}=e;if(n){if(!function(e){return null!=e&&!0===x.spatialRelationship[e]}(r))throw new s.A(m,"Unsupported query spatial relationship",{query:e});if((0,o.fn)(n.spatialReference)&&(0,o.fn)(i)){if(!function(e){return null!=e&&!0===x.queryGeometry[(0,a.$B)(e)]}(n))throw new s.A(m,"Unsupported query geometry type",{query:e});if(!function(e){return null!=e&&!0===x.layerGeometry[e]}(t))throw new s.A(m,"Unsupported layer geometry type",{query:e});if(e.outSR)return(0,f.Nk)(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function _(e){if((0,a.ZC)(e))return!0;if((0,a.Bi)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},23478:(e,t,i)=>{function s(e,t){if(!e)return null;const i=t.featureAdapter,{startTimeField:s,endTimeField:r}=e;let n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(s&&r)t.forEach((e=>{const t=i.getAttribute(e,s),o=i.getAttribute(e,r);null==t||isNaN(t)||(n=Math.min(n,t)),null==o||isNaN(o)||(a=Math.max(a,o))}));else{const e=s||r;t.forEach((t=>{const s=i.getAttribute(t,e);null==s||isNaN(s)||(n=Math.min(n,s),a=Math.max(a,s))}))}return{start:n,end:a}}function r(e,t,i){if(!t||!e)return null;const{startTimeField:s,endTimeField:r}=e;if(!s&&!r)return null;const{start:n,end:a}=t;return null===n&&null===a?null:void 0===n&&void 0===a?()=>!1:s&&r?function(e,t,i,s,r){return null!=s&&null!=r?n=>{const a=e.getAttribute(n,t),o=e.getAttribute(n,i);return(null==a||a<=r)&&(null==o||o>=s)}:null!=s?t=>{const r=e.getAttribute(t,i);return null==r||r>=s}:null!=r?i=>{const s=e.getAttribute(i,t);return null==s||s<=r}:void 0}(i,s,r,n,a):function(e,t,i,s){return null!=i&&null!=s&&i===s?s=>e.getAttribute(s,t)===i:null!=i&&null!=s?r=>{const n=e.getAttribute(r,t);return n>=i&&n<=s}:null!=i?s=>e.getAttribute(s,t)>=i:null!=s?i=>e.getAttribute(i,t)<=s:void 0}(i,s||r,n,a)}i.d(t,{I:()=>r,W:()=>s})}}]);
//# sourceMappingURL=3616.6be6deac.chunk.js.map